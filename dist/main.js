(()=>{"use strict";class t{constructor(t){this.title=t}getTitle(){return this.title}setTitle(t){this.title=t}}class e{constructor(t){this.name=t,this.taskList=[]}getName(){return this.name}setName(t){this.name=t}getTaskList(){return this.taskList}setTaskList(t){this.taskList=t}addTask(t){this.taskList.push(t)}containsTask(t){for(let e=0;e<this.taskList.length;e++)if(t==this.taskList[e].title)return!0;return!1}deleteTask(t){this.taskList=this.taskList.filter((e=>e.title!=t))}findTask(t){return this.taskList.find((e=>e.getTitle()==t))}}const s=document.getElementById("tasks"),a=document.getElementById("task-form"),n=document.getElementById("curr-project");let l=new class{constructor(){this.projects=[],this.projectNames=[],this.currProject=""}getCurrProject(){return this.currProject}setCurrProject(t){this.currProject=t}getProjects(){return this.projects}setProjects(t){this.projects=t}getProject(t){return this.projects.find((e=>e.getName()==t))}addProject(t){this.projects.push(t)}addProjectName(t){this.projectNames.push(t)}getProjectNames(){return this.projectNames}deleteProject(t){this.projects=this.projects.filter((e=>e.getName()!=t))}deleteProjectName(t){this.projectNames=this.projectNames.filter((function(e){return e!=t}))}},c=new e("All tasks");function r(t){const e=document.createElement("div");e.classList.add("task-btns");const a=document.createElement("button"),n=document.createElement("button");a.innerText="Edit",a.classList.add("edit-btn"),a.addEventListener("click",(t=>function(t){const e=t.target.parentNode.parentNode,s=e.querySelector(".text-content"),a=e.querySelector(".edit-form"),n=e.querySelector(".confirm-edit");a.value=s.innerText,a.classList.toggle("hidden"),n.classList.toggle("hidden"),s.classList.toggle("hidden"),console.log(l.getCurrProject())}(t))),n.innerText="Del",n.classList.add("del-btn"),n.addEventListener("click",(t=>function(t){const e=t.target.parentNode.parentNode,a=e.querySelector(".text-content");"All tasks"==l.getCurrProject()?(l.getProject("All tasks").deleteTask(a.innerText),localStorage.setItem("All tasks",JSON.stringify(l.getProject("All tasks").getTaskList()))):(l.getProject("All tasks").deleteTask(a.innerText),l.getProject(l.getCurrProject()).deleteTask(a.innerText),localStorage.setItem("All tasks",JSON.stringify(l.getProject("All tasks").getTaskList())),localStorage.setItem(l.getCurrProject(),JSON.stringify(l.getProject(l.getCurrProject()).getTaskList()))),s.removeChild(e)}(t))),e.appendChild(a),e.appendChild(n),t.appendChild(e)}function o(t){console.log(l.getCurrProject());const e=t.target.parentNode,s=e.querySelector(".text-content"),a=e.querySelector(".edit-form"),n=e.querySelector(".confirm-edit");console.log("before edit:"),console.log(l.getProject("All tasks").getTaskList()),console.log(l.getProject(l.getCurrProject()).getTaskList()),"All tasks"==l.getCurrProject()?(l.getProject("All tasks").findTask(s.innerText).setTitle(a.value),localStorage.setItem("All tasks",JSON.stringify(l.getProject("All tasks").getTaskList())),l.getProjects().forEach((t=>{t.containsTask(s.innerText)&&(t.findTask(s.innerText).setTitle(a.value),localStorage.setItem(t.getName(),JSON.stringify(t.getTaskList())))}))):(l.getProject("All tasks").findTask(s.innerText).setTitle(a.value),l.getProject(l.getCurrProject()).findTask(s.innerText).setTitle(a.value),localStorage.setItem("All tasks",JSON.stringify(l.getProject("All tasks").getTaskList())),localStorage.setItem(l.getCurrProject(),JSON.stringify(l.getProject(l.getCurrProject()).getTaskList()))),console.log("after edit:"),console.log(l.getProject("All tasks").getTaskList()),console.log(l.getProject(l.getCurrProject()).getTaskList()),s.innerText=a.value,e.id=a.value,a.classList.toggle("hidden"),n.classList.toggle("hidden"),s.classList.toggle("hidden")}function i(t){const e=l.getProject(t),a=s.childNodes;for(let t=0;t<a.length;t++)e.containsTask(a[t].id)?(a[t].classList.remove("hidden"),a[t].classList.add("task")):(a[t].classList.add("hidden"),a[t].classList.remove("task"));l.setCurrProject(t)}l.addProject(c),l.setCurrProject("All tasks"),n.innerText="All tasks",a.addEventListener("submit",(e=>function(e,n){e.preventDefault();const c=document.getElementById("task-title").value;if(l.getProject("All tasks").containsTask(c))return alert("Task already exists!"),void a.reset();const i=document.createElement("div");if(i.classList.add("task"),i.id=c,"All tasks"==n){let e=new t(c);l.getProject(n).addTask(e),localStorage.setItem("All tasks",JSON.stringify(l.getProject("All tasks").getTaskList()))}else{let e=new t(c),s=new t(c);l.getProject("All tasks").addTask(e),localStorage.setItem("All tasks",JSON.stringify(l.getProject("All tasks").getTaskList())),l.getProject(n).addTask(s),localStorage.setItem(n,JSON.stringify(l.getProject(n).getTaskList()))}const d=document.createElement("div");d.innerText=c,d.classList.add("text-content"),d.classList.add("hidden"),d.classList.toggle("hidden");const g=document.createElement("input"),m=document.createElement("button");m.addEventListener("click",(t=>o(t))),m.innerHTML="&check;",m.classList.add("hidden"),m.classList.add("confirm-edit"),g.classList.add("hidden"),g.classList.add("edit-form"),g.autocomplete="off",g.type="text",g.placeholder="edit task...",i.appendChild(g),i.appendChild(m),i.appendChild(d),r(i),s.appendChild(i),a.reset()}(e,l.getCurrProject()))),document.addEventListener("DOMContentLoaded",(()=>{let a=JSON.parse(localStorage.getItem("All tasks"));null!=a&&a.forEach((e=>{!function(t){const e=document.createElement("div");e.classList.add("task");const a=t;e.id=a;const n=document.createElement("div");n.innerText=a,n.classList.add("text-content"),n.classList.add("hidden"),n.classList.toggle("hidden");const l=document.createElement("input"),c=document.createElement("button");c.addEventListener("click",(t=>o(t))),c.innerHTML="&check;",c.classList.add("hidden"),c.classList.add("confirm-edit"),l.classList.add("hidden"),l.classList.add("edit-form"),l.autocomplete="off",l.type="text",l.placeholder="edit task...",e.appendChild(l),e.appendChild(c),e.appendChild(n),r(e),s.appendChild(e)}(e.title);const a=new t(e.title);l.getProject("All tasks").addTask(a)}));let n=JSON.parse(localStorage.getItem("projects"));null!=n&&n.forEach((s=>{const a=new e(s);l.addProject(a),l.addProjectName(a.getName()),function(t){const e=document.createElement("div"),s=document.createElement("button");e.addEventListener("click",(()=>{k(t),i(t)}));const a=document.getElementById("projects");e.innerText=t,e.id=t,e.classList.add("project-tab"),s.classList.add("project-btn"),s.innerText="x",s.addEventListener("click",(e=>{e.stopPropagation(),j(t),k("All tasks"),i("All tasks")})),e.appendChild(s),a.appendChild(e)}(s);let n=JSON.parse(localStorage.getItem(s));null!=n&&n.forEach((e=>{const s=new t(e.title);l.getProject(a.getName()).addTask(s)}))}))})),document.getElementById("all-tasks").addEventListener("click",(()=>{i("All tasks"),k("All tasks")}));const d=document.getElementById("add-project"),g=document.getElementById("project-title"),m=document.getElementById("confirm-project"),u=document.getElementById("cancel-project");function k(t){l.setCurrProject(t),n.innerText=t}function j(t){l.deleteProject(t),l.deleteProjectName(t);const e=l.getProjectNames();localStorage.setItem("projects",JSON.stringify(e));const s=document.getElementById(t);document.getElementById("projects").removeChild(s)}d.addEventListener("click",(()=>{g.classList.toggle("hidden"),m.classList.toggle("hidden"),u.classList.toggle("hidden"),g.value=""})),u.addEventListener("click",(()=>{g.classList.toggle("hidden"),m.classList.toggle("hidden"),u.classList.toggle("hidden"),g.value=""})),m.addEventListener("click",(()=>{const t=g.value;if(""==t)return void alert("Please enter a project name!");if(l.getProjectNames().includes(t))return alert("Project with that name already exists!"),void(g.value="");let s=new e(t);l.addProject(s),l.addProjectName(s.getName()),g.classList.toggle("hidden"),m.classList.toggle("hidden"),u.classList.toggle("hidden"),g.value="";const a=document.createElement("div");a.classList.add("project-tab");const n=document.createElement("button");a.addEventListener("click",(()=>{k(s.getName()),i(s.getName())}));const c=document.getElementById("projects");a.innerText=s.getName(),a.id=s.getName(),n.classList.add("project-btn"),n.innerText="x",n.addEventListener("click",(t=>{t.stopPropagation(),j(s.getName()),k("All tasks"),i("All tasks")})),a.appendChild(n),c.appendChild(a),k(s.getName()),i(s.getName()),localStorage.setItem("projects",JSON.stringify(l.getProjectNames()))}))})();